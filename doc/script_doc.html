<!DOCTYPE html "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
   <head>
      <title>Dokumentation bksystem scripte</title>
      <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   </head>
   <body>
      <h1>Dokumentation bksystem script</h1>
      <div id="toc_div">
         <h3>Übersicht</h3>

        <ol id="toc">
            <li><a href=#general>allgemein</a></li>
            <ul>
               <li><a href=#shell>Shell</a></li>
               <li><a href=#software>Software: sqlite3</a></li>
            </ul>
            <li><a href=#user_accounts>master script: all_bill_jobs.sh</a></li>
            <ul>
               <li><a href=#function_master>Function</a></li>
               <li><a href=#config_paths>Pfade konfigurieren</a></li>
               <li><a href=#active>einzelne script de/aktivieren</a></li>
               <li><a href=#crontab>stand alone</a></li>
            </ul>
            <li><a href=#insert>Jetzt abrechnen: insert_bill_date.sh </a></li>
            <ul>
               <li><a href=#></a></li>
            </ul>
            <li><a href=#export>Export: export_bill_basic.sh</a></li>
            <ul>
               <li><a href=#></a></li>
            </ul>
            <li><a href=#pivot_table>pivot Tabelle generieren + export: export_bill_complete(_sep).sh</a></li>
            <ul>
               <li><a href=#></a></li>
            </ul>
            <li><a href=#cleanup>cleanup: export_bill_basic.sh</a></li>
            <ul>
               <li><a href=#></a></li>
            </ul>
            <li><a href=#backup>Backup: backup.sh und restore.sh</a></li>
            <li><a href=#crontab>Crontab</a></li>
         </ol>
      </div>
      <div id="content_div">
        <ol id="content">
            <h3 id="general"><li>allgemein</li></h3>
            <ul>
               <h4 id="shell"><li>Shell</li></h4>
               <p>Es ist gedacht, dass alle Skripte regelmäßig automatisch mit Hilfe von <a href=#crontab title="zu Crontab springen">crontab</a> ausgeführt werden. </p>
               <p><ul>
                  <li>BKS_DATE: Abrechnungsdatum</li>
                  <li>BKS_SCR_DIR: Verzeichnis der Skripte</li>
                  <li>BKS_DB_DIR: Pfad und Datenbankname</li>
                  <li>BKS_DB_NAME: Datenbankname</li>
                  <li>BKS_BILL_DIR: Pfad zum Verzeichnis für Abrechnungen</li>
                  <li>BKS_TMP_DIR: Pfad zum temporären Verzeichnis</li>
                  <li>BKS_BKP_DIR: Pfad zum Verzeichnis zum Backups schreiben oder lesen</li>
                  <li>BKS_LOG_DIR: Pfad zum Verzeichnis für log Datei</li>
                  <li>BKS_LOG_FILE:Log-Dateiname</li>
               </ul></p>
               <h4 id="software"><li>Software: sqlite3</li></h4>
               <p>Alle Skripte benötigen das commandline tool sqlite3, um die Datenabfragen zu stellen.</p>
               <p><a href="http://www.google.de/search?q=man+sqlite3&btnI=aufgutglück" title="Manual sqlite3 anzeigen">Manual sqlite3</a></p>
            </ul>
            <h3 id="all_jobs"><li>master script: bksystem.sh</li></h3>
            <ul>
               <h4 id="function_master"><li>Funktion</li></h4>
               <p>In bksystem.sh sind alle Konfigurationen gespeichert. Das sind zum einen Defaultwerte für die Pfad und Dateiname. Zum anderen sind das die Funktionen, die automatisch, bzw. regelmäßig ausgeführt werden sollen. Des weiteren akzeptiert das script eine Reihe von Komandozeilen Optionen.</p>
                  
               <h4 id="config_paths"><li>Pfade konfigurieren</li></h4>
               <p>Eigentlich sollte es reichen, nur das DEF_ROOT_DIR zu setzen e.g. /home/bierwart/bksystem. Alle anderen Pfade werden relativ dazu gesetzt</p>
               <p><table border=1>
                  <tr><th>VARNAME</th> <th>Bedeutung</th> <th>initial Wert</th></tr>
                  <tr><th>DEF_ROOT_DIR</th> <th>Hauptverzeichnis</th><th>nicht gesetzt</th></tr>
                  <tr><th>DEF_DATE</th> <th>Abrechnungsdatum</th> <th>Setze auf "Jetzt"</th></tr>
                  <tr><th>DEF_SCR_DIR</th> <th>Verzeichnis der Skripte</th> <th>ROOT_DIR/scripts</th></tr>
                  <tr><th>DEF_DB_DIR</th> <th>Pfad zur Datenbank</th> <th>ROOT_DIR/</th></tr>
                  <tr><th>DEF_DB_NAME</th> <th>Datenbankname</th> <th>bksystem.sqlite</th></tr>
                  <tr><th>DEF_BILL_DIR</th> <th>Pfad zum Verzeichnis für Abrechnungen</th> <th>ROOT_DIR/bills</th></tr>
                  <tr><th>DEF_TMP_DIR</th> <th>Pfad zum temporären Verzeichnis</th> <th>ROOT_DIR/tmp</th></tr>
                  <tr><th>DEF_BKP_DIR</th> <th>Pfad zum Verzeichnis zum Backups schreiben oder lesen</th> <th>ROOT_DIR/bkp</th></tr>
                  <tr><th>DEF_LOG_DIR</th> <th>Pfad zum Verzeichnis für log Datei</th> <th>ROOT_DIR/log</th></tr>
                  <tr><th>DEF_LOG_FILE</th> <th>Log-Dateiname</th> <th>bill_script.log</th></tr>
               </table></p>
               <h4 id="active"><li>Konfiguration: einzelne scripte de/aktivieren</li></h4>
               <p></p>
               <h4 id="crontab"><li>stand alone</li></h4>
               <h4 id="structure"><li>Aufbau</li></h4>
            </ul>
            <h3 id="subscripte">Sub-scripte</h3>
            <p>Diese Scripte werden alle vom masterscript bksystem.sh aufgerufen. Es lassen sich aber auch alle in einer shell direkt ausführen. Dabei kann die Datenbank (evtl. mit Pfad) als erstes Argument angegeben werden. Alle Dateien werden dann ins/vom Arbeitsverzeichnis geschrieben/gelesen. Alternativ können folgende Pfadvariable gesetzt werden mit <a href="http://www.google.de/search?q=man+export&btnI=auf+gut+glück" title="Manual export">export</a>. Benutzte Variablen und dateien stehen bei den Skriptbeschreibungen.
            <h3 id="insert"><li>Jetzt abrechnen: insert_bill_date.sh </li></h3>
            <ul>
               <h4 id="insert_func"><li>Funktion</li></h4>
               <h4 id="insert_structure"><li>Aufbau</li></h4>
            </ul>
            <h3 id="export"><li>Export: export_bill_basic.sh</li></h3>
            <p></p>
            <ul>
               <h4 id="export_func"><li>Funktion</li></h4>
               <h4 id="export_structure"><li>Aufbau</li></h4>
            </ul>
            <h3 id="pivot_table"><li>pivot Tabelle generieren + export: export_bill_complete(_sep).sh</li></h3>
            <ul>
               <h4 id="pivot_table_func"><li>Fuinktion</li></h4>
               <h4 id="pivot_table_structure"><li>Aufbau</li></h4>
            </ul>
            <h3 id="pivot_table_html"><li>pivot Tabelle generieren + export als html mit layout: export_bill_html.sh</li></h3>
            <ul>
               <h4 id="pivot_table_html_func"><li>Fuinktion</li></h4>
               <h4 id="pivot_table_html_structure"><li>Aufbau</li></h4>
            </ul>
            <h3 id="cleanup"><li>cleanup: clean_old_sales.sh</li></h3>
            <ul>
               <h4 id="cleanup_func"><li>Funktionen</li></h4>
               <h4 id="cleanup_structure"><li>Aufbau</li></h4>
            </ul>
            <h3 id="backup"><li>Backup: backup.sh und restore.sh</li></h3>
            <ul>
               <h4 id="backup_func"><li>Funktionen</li></h4>
               <h4 id="backup_structure"><li>Aufbau</li></h4>
            </ul>
            <h3 id="crontab"><li>Crontab</li></h3>
         </ol>
         
      </div>
   </body>
